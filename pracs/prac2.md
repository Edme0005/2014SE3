Practical 2 -- finding regressions using GIT
============================================

Today's prac consists of using the git bisect command to search through the history of a repository to discover when a regression was introduced.

Source control makes this possible, because all versions of each source file are retained.

Good source control tools make it easy, by optimising and facilitating the search through the commit history.

GIT provides the 'bisect' facility, where you can specify the range of commits you want to search through, and then have GIT prompt you as to which commit you should next test.  GIT uses a binary search, so 2^n commits can be tested using only n steps.  For 1,000 commits, this would be about 10 steps -- a significant time saving!

For further reading, refer to http://git-scm.com/docs/git-bisect

Getting started
---------------

Begin by making sure you have cloned this repository into a convenient place. If not, you can clone it now with commands like:

    git clone git://github.com/gardners/2014SE3
    cd 2014SE3

If you already have your own fork of the 2014SE3 repository, then you will need to pull the changes from the master repository to your local copy with something like:

    git checkout master
    git pull git://github.com/gardners/2014SE3

You probably want to push that back onto your fork of the repository github:

    git push origin

Choosing which exercise to do
-----------------------------

In the `pracs/prac2/students` directory there are several numbered directories.  Choose one randomly to use.

Inside each directory there is a file, `mutated.c`, that is the program we are testing to determine which commit caused it to begin failing tests.  

Each `mutated.c` file has been generated by moving lines around within a working program.  There will be a number such changes that do not cause the program to fail tests, followed by at least one commit that introduces an error, causing it to fail at least one test.  

You can explore the history of your chosen `mutated.c` from the github web interface by navigating to the appropriate directory, clicking on the file, and then clicking on "history" to see the list of commits.  Clicking on each commit will show the simple change made in that commit. 

You can also explore the history from the command line using a command like:

    git log pracs/prac2/students/6/mutated.c
    
That command will show all commits that modified the file `pracs/prac2/students/6/mutated.c`.  Make sure to replace the file name with the one you are interested in!

Starting to bisect
------------------

From in your `2014SE3` directory, run the following git command to tell it you want to start bisecting:

    git bisect reset
    git bisect start pracs/prac2/students/6
    git bisect bad
    
This tells git that you only care about commits that modify files in the `pracs/prac2/students/6` directory, and that the latest commit is bad.

Now you need to tell git about a commit that is good.  Use a command like the following (but remember to change the filename to match the one you are using) to get the history of the `mutated.c` file you are working on:

    git log pracs/prac2/students/2/mutated.c
    
This will display a block of output for each commit.  There may be many or few commits for the example you are using.  The newest commit will be at the top, and the oldest at the bottom.  You may need to press SPACE a few times for it to scroll to the end of the list.  

At the end of the list, look for the last line that begins with `commit`.  It will be followed by a long hexadecimal number.  That number is the unique identifier for that commit.  Use the mouse to select it, so that you can paste it into a git command in a moment.  Once done, you can press Q to exit back to the shell.

Now type `git bisect good `, and then paste that hexidecimal string onto the end of the command, and press ENTER.

You should then see output including something like:

    Bisecting: 20 revisions left to test after this (roughly 4 steps)
    
If you see something like the following:

    error: Your local changes to the following files would be overwritten by checkout:
	    pracs/prac2/students/5/mutated.c
	    pracs/prac2/students/6/mutated.c
    Please, commit your changes or stash them before you can switch branches.
    Aborting
    
You need to clean up your repository.  Something like:

    git reset --hard origin/master
    
Will reset it back to whatever you lasted pushed to github.
